# Scenario: Basic JSONRPC request/response over WebSocket (Agent perspective)
# Note: This is a non-executable scaffold to outline intended flows with runn.

version: "1"
name: basic-jsonrpc-over-ws
vars:
  ws_url: ${NEXT_PUBLIC_WS_URL_DEFAULT:-ws://localhost:8080}

steps:
  - name: connect
    desc: Agent opens a WebSocket connection
    ws:
      connect:
        url: "{{ ws_url }}"

  - name: send-request
    desc: Agent sends a JSONRPC 2.0 request {method:"ping",id:1}
    ws:
      send:
        json:
          jsonrpc: "2.0"
          method: "ping"
          params: { }
          id: 1

  - name: expect-response
    desc: Agent receives a matching response with id=1
    ws:
      recv:
        assert:
          and:
            - "+/jsonrpc": "2.0"
            - "+/id": 1
            - or:
                - exists: "+/result"
                - exists: "+/error"

  - name: close
    desc: Agent closes the connection
    ws:
      close: {}
